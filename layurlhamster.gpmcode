{"Id":"269e2fa9-357d-49bb-b9d9-885d114d1416","ActionOrBlocks":[{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":0,"Name":"Normal","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":2,"Title":"Truy cập URL","ElementXpath":"","RawInput":"https://web.telegram.org/k/#@hamster_kombat_bot","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":8,"Title":"Chờ Element","ElementXpath":"//*[text()='START']","RawInput":"10","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":12,"Title":"Click chuột","ElementXpath":"//*[text()='START']","RawInput":"","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":8,"Title":"Chờ Element","ElementXpath":"//*[text()='Play']","RawInput":"10","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":12,"Title":"Click chuột","ElementXpath":"//*[text()='Play']","RawInput":"","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":8,"Title":"Chờ Element","ElementXpath":"//*[text()='Launch']","RawInput":"10","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":3,"Name":"Kiểm tra nút Launch","ActionOrBlocks":[{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":4,"Name":"If","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":12,"Title":"Click chuột","ElementXpath":"//*[text()='Launch']","RawInput":"","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}}],"BlockCondition":"","ForBlockLoopCount":null,"IsExpandUI":true}},{"Type":1,"Action":{"ActionType":0,"Title":null,"ElementXpath":null,"RawInput":null,"VariableNameForOutput":null},"Block":{"BlockType":5,"Name":"Else","ActionOrBlocks":[{"Type":0,"Action":{"ActionType":28,"Title":"Dừng chờ","ElementXpath":"","RawInput":"1000,2000","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}}],"BlockCondition":"","ForBlockLoopCount":"","IsExpandUI":true}}],"BlockCondition":"hasElement(//*[text()='Launch'])","ForBlockLoopCount":"","IsExpandUI":true}},{"Type":0,"Action":{"ActionType":8,"Title":"Chờ Element","ElementXpath":"//iframe","RawInput":"10","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":30,"Title":"Chạy mã Javascript lấy game url","ElementXpath":"","RawInput":"return decodeURIComponent(document.querySelector('iframe').getAttribute('src').replace('tgWebAppPlatform=weba','tgWebAppPlatform=android').replace('tgWebAppPlatform=web','tgWebAppPlatform=android'))","VariableNameForOutput":"gameUrl"},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":21,"Title":"Switch qua frame","ElementXpath":"//iframe","RawInput":"","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":30,"Title":"Bypass mobile","ElementXpath":"","RawInput":"window.changeHashPlatform=()=>{var a=location.hash.toString();-1!==a.indexOf(\"tgWebAppPlatform=weba\")?a=a.replaceAll(\"tgWebAppPlatform=weba\",\"tgWebAppPlatform=android\"):-1!==a.indexOf(\"tgWebAppPlatform=web\")&&(a=a.replaceAll(\"tgWebAppPlatform=web\",\"tgWebAppPlatform=android\")),location.hash=a,location.reload()},window.changeHashPlatform(),addEventListener(\"hashchange\",a=>{window.changeHashPlatform()});","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":8,"Title":"Chờ Element mở box","ElementXpath":"//*[@class='bottom-sheet open']","RawInput":"30","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":30,"Title":"Chạy mã Javascript lấy token","ElementXpath":"","RawInput":"return localStorage.getItem('$authToken') || 'null';","VariableNameForOutput":"tokenAuth"},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":36,"Title":"Tạo excel workbook","ElementXpath":"","RawInput":"D:\\test1.xlsx","VariableNameForOutput":"wb"},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":33,"Title":"Ghi excel profile","ElementXpath":null,"RawInput":"$wb;A;$profile_name","VariableNameForOutput":null},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":33,"Title":"Ghi excel game url","ElementXpath":null,"RawInput":"$wb;B;$gameUrl","VariableNameForOutput":null},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":33,"Title":"Ghi excel token","ElementXpath":null,"RawInput":"$wb;C;$tokenAuth","VariableNameForOutput":null},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}},{"Type":0,"Action":{"ActionType":28,"Title":"Dừng chờ","ElementXpath":"","RawInput":"1000,2000","VariableNameForOutput":""},"Block":{"BlockType":0,"Name":null,"ActionOrBlocks":[],"BlockCondition":null,"ForBlockLoopCount":null,"IsExpandUI":false}}],"BlockCondition":"","ForBlockLoopCount":null,"IsExpandUI":true}}],"VariableData":[{"Name":"excel","Action":null},{"Name":"profile_id","Action":null},{"Name":"profile_name","Action":null},{"Name":"loopIndex","Action":null},{"Name":"gameUrl","Action":{"ActionType":10,"Title":"Đọc Attribute element","ElementXpath":"//iframe","RawInput":"src","VariableNameForOutput":"gameUrl"}},{"Name":"wb","Action":{"ActionType":36,"Title":"Tạo excel workbook","ElementXpath":"","RawInput":"D:\\test1.xlsx","VariableNameForOutput":"wb"}},{"Name":"tokenAuth","Action":{"ActionType":30,"Title":"Chạy mã Javascript lấy token","ElementXpath":"","RawInput":"return localStorage.getItem('$authToken') || 'null';","VariableNameForOutput":"tokenAuth"}}]}